if("undefined"==typeof magento)var magento={};magento.glossary={url:"https://jcalcaben.github.io/magento-glossary/",terms:[],init:function(dataUrl,filter,callback){$.get(dataUrl,function(data){glossary=magento.glossary,glossaryData=$($.parseXML(data)),glossaryData.find("term").each(function(){return glossary.processTerm(filter,$(this))}),callback()},"text")},processTerm:function(filter,term){var glossary=magento.glossary,unserializedTerm=glossary.unserializeTerm(term);filter(unserializedTerm)&&glossary.terms.push(unserializedTerm)},unserializeTerm:function(termXmlData){var data={};return data.id=termXmlData.find("uuid").text(),data.title=termXmlData.find("title").text(),data.types=magento.glossary.unserializeList(termXmlData.find("types type")),data.forms=magento.glossary.unserializeFormTypes(termXmlData.find("form-types form")),data.synonyms=magento.glossary.unserializeList(termXmlData.find("synonyms synonym")),data.primarySource=termXmlData.find("primary-source").text().toLowerCase(),data.contentTagsArray=magento.glossary.unserializeList(termXmlData.find("content-tags content-tag")).map(function(value){return value.replace(/[\s\/]+/,"-")}),data.userTagsArray=magento.glossary.unserializeList(termXmlData.find("user-tags user-tag")),data.shortDefinition=termXmlData.find("short-definition").text().replace(/(?:\r\n|\r|\n)/g,"<br />"),data.longDefinition=termXmlData.find("long-definition").text().replace(/(?:\r\n|\r|\n)/g,"<br />"),data.usage=termXmlData.find("usage").text(),data.referenceLinks=magento.glossary.unserializeReferenceLinks(termXmlData.find("reference-links reference-link")),data},unserializeList:function(xmlList){for(var list=[],i=0;i<xmlList.length;i++)content=xmlList[i].textContent.toLowerCase(),content&&list.push(content);return list},unserializeFormTypes:function(forms){for(var formTypes=new Map,i=0;i<forms.length;i++){var types=$(forms[i]),text=types.attr("text").trim();text&&(formTypes.has(text)||formTypes.set(text,[]),formTypes.set(text,magento.glossary.unserializeList($("form-type",types))))}return formTypes},unserializeReferenceLinks:function(refLinks){for(var links=[],i=0;i<refLinks.length;i++){var link={location:$("location",refLinks[i])[0].textContent,text:$("text",refLinks[i])[0].textContent};links.push(link)}return links}},magento.glossary.page={init:function(){magento.glossary.page.filter.init(),magento.glossary.page.insertGroupLinks()},insertTerms:function(terms,callback){function metadataToggle(eventObject){magento.glossary.page.toggleDisplay(eventObject.target,"Show Metadata","Hide Metadata",".metadata")}function definitionToggle(eventObject){magento.glossary.page.toggleDisplay(eventObject.target,"More","Less",".long-definition")}"undefined"==typeof terms&&(terms=magento.glossary.terms);for(var i=0;i<terms.length;i++){var group="Num",group=/[a-zA-Z]/.test(terms[i].title[0])?terms[i].title[0].toUpperCase():/[0-9]/.test(terms[i].title[0])?"Num":terms[i].title.match(/[a-zA-Z]/i)[0].toUpperCase(),termTemplate=$("#termTemplate").html(),termGroupTemplate=$("#termGroupTemplate").html();0==$("#"+group+"-container").length&&$(Mustache.render(termGroupTemplate,{group:group})).appendTo("#glossary-terms");var forms=[],keys=terms[i].forms.keys();terms[i].referenceLinks.length&&(terms[i].showReferenceLinks=!0);do iter=keys.next().value,iter&&forms.push({form:iter,types:terms[i].forms.get(iter)});while(iter);terms[i].forms=forms,terms[i].baseurl=magento.glossary.url,$(Mustache.render(termTemplate,terms[i])).insertBefore("#"+group+"-container .back-to-top")}window.location.hash?(window.location.search="",window.location.href=window.location.hash):magento.glossary.page.filter.applyUrlFilter(),$(".term-data .toggle-metadata").click(metadataToggle),$(".term-data .show-definition").click(definitionToggle),callback&&callback()},toggleDisplay:function(toggleSwitch,textShow,textHide,selector){var target=$(selector,$(toggleSwitch).parentsUntil(".term",".term-data"));target.hasClass("hidden")?(target.addClass("show").removeClass("hidden"),$(toggleSwitch).text(textHide)):(target.addClass("hidden").removeClass("show"),$(toggleSwitch).text(textShow))},insertGroupLinks:function(){var renderer=magento.glossary.page.renderer;renderer.render("./js/templates/termGroupLink.mst",{groups:[{targetAnchor:"A",buttonText:"A-C",id:"a-c"},{targetAnchor:"D",buttonText:"D-F",id:"d-f"},{targetAnchor:"G",buttonText:"G-I",id:"g-i"},{targetAnchor:"J",buttonText:"J-L",id:"j-l"},{targetAnchor:"M",buttonText:"M-O",id:"m-o"},{targetAnchor:"P",buttonText:"P-R",id:"p-r"},{targetAnchor:"S",buttonText:"S-U",id:"s-u"},{targetAnchor:"V",buttonText:"V-Z",id:"v-z"},{targetAnchor:"",buttonText:"Back to Top",id:"top"}]},function(html){$("#term-groups").append(html)})}},magento.glossary.page.filter={init:function(){var filter=magento.glossary.page.filter;filter.appendTagFilter("Audience","checkbox","user-tag",null,[{id:"developer",text:"Developer"},{id:"merchant",text:"Merchant"},{id:"internal",text:"Internal"}],$("#user-tags")),filter.appendTagFilter("Content Type","checkbox","content-tag","content-type",[{id:"business-marketing",text:"Business/Marketing"},{id:"design",text:"Design"},{id:"magento-software",text:"Magento Software"},{id:"pricing",text:"Pricing"},{id:"product",text:"Product"},{id:"programming",text:"Programming"},{id:"order",text:"Order"}],$("#content-tags")),filter.appendTagFilter("Primary Source","radio","source","primary-source",[{id:null,text:"All"},{id:"design",text:"Design"},{id:"devdocs",text:"DevDocs"},{id:"marketing",text:"Marketing"},{id:"training",text:"Training"},{id:"userdocs",text:"UserDocs"},{id:"ux",text:"UX"}],$("#primary-source"))},appendTagFilter:function(label,inputType,prefix,name,options,target){var renderer=magento.glossary.page.renderer;renderer.render("./js/templates/tagFilterTemplate.mst",{label:label,inputType:inputType,prefix:prefix,name:name,options:options},function(html){var filter=magento.glossary.page.filter;if(target.append(html),$(".filter input").click(filter.updateFilter),""==window.location.hash)for(var filterSelectors=filter.getFilterSelectors(filter.getUrlParams()),i=0;i<filterSelectors.length;i++)$("input#"+filterSelectors[i]).prop("checked",!0)})},getUrlParams:function(url){var queryString=url?url.split("?")[1]:window.location.search.slice(1),params={};if(queryString)for(var paramStrings=queryString.split("&"),i=0;i<paramStrings.length;i++)if(paramStrings[i]){var paramKeyValue=paramStrings[i].split("=");params[paramKeyValue[0]]?params[paramKeyValue[0]].push(paramKeyValue[1].toLowerCase()):params[paramKeyValue[0]]=[paramKeyValue[1].toLowerCase()]}return params},createFilterParamsUrl:function(){for(var checkedFilters=$(".filter input:checked"),paramsUrl=[],i=0;i<checkedFilters.length;i++){var value=checkedFilters[i].value;value.startsWith("user-tag-")&&paramsUrl.push("audience="+value.split("-").slice(2).join("-")),value.startsWith("content-tag-")&&paramsUrl.push("content="+value.split("-").slice(2).join("-")),value.startsWith("source-")&&paramsUrl.push("source="+value.split("-").slice(1).join("-"))}return paramsUrl.join("&")},applyFilters:function(classList){void 0==typeof classList&&(classList=magento.glossary.page.filter.filterClassList),$(".term").removeClass("show").addClass("hidden");var filter=classList.map(function(element){return element?"."+element:""}).join("");$(".term"+filter).removeClass("hidden").addClass("show")},updateFilter:function(){filterClassList=[],$(".filter input:checked").each(function(){filterClassList.push($(this).val())}),console.log(filterClassList),window.location.hash="",window.location.search=magento.glossary.page.filter.createFilterParamsUrl()},applyUrlFilter:function(){var filter=magento.glossary.page.filter;urlParams=filter.getUrlParams(),filter.applyFilters(magento.glossary.page.filter.getFilterSelectors(urlParams))},getFilterSelectors:function(urlParams){var filterSelectors=[];if(urlParams.source&&filterSelectors.push("source-"+urlParams.source[0]),urlParams.audience)for(var i=0;i<urlParams.audience.length;i++)filterSelectors.push("user-tag-"+urlParams.audience[i]);if(urlParams.content)for(var i=0;i<urlParams.content.length;i++)filterSelectors.push("content-tag-"+urlParams.content[i]);return filterSelectors}},magento.glossary.page.renderer={cache:{},init:function(){},render:function(templateName,params,callback){var renderer=magento.glossary.page.renderer;renderer.cache[templateName]?callback(Mustache.render(renderer.cache[templateName],params)):$.get(templateName,function(template){renderer.cache[templateName]=template,callback(Mustache.render(template,params))})}},magento.glossary.tooltip={init:function(){$('[data-toggle="popover"]').each(function(){var term=magento.glossary.terms.find(magento.glossary.tooltip._findTerm,$(this).attr("term-uuid"));if(term){var title="<a href='"+magento.glossary.url+"?#"+term.id+"'>"+term.title+"</a>",content=term.shortDefinition;$(this).webuiPopover({title:title,content:content,width:"300px"})}else console.error("Could not find term with id "+$(this).attr("term-uuid"))})},_findTerm:function(element){return element.id==this}};
